---
title: "Relatório Estatística Experimental"
author: 
  - "Guilherme Fernandes - 3398"
  - "Júlia Letícia - 3732"
  - "Victor Hugo - 3510"
date: "03/08/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("../funcoes.R")
library(magrittr)
library(ggplot2)
```

```{r}
# descritiva <- function(df, variavel, grupo) {
#   variavel <- dplyr::sym(variavel)
#   grupo <- dplyr::sym(grupo)
#   
#   
#   resultado <- df %>% 
#       dplyr::group_by(!!grupo) %>% 
#       dplyr::summarise("Mediana" = round(median(!!variavel), 2),
#     									 "Média" = round(mean(!!variavel), 2),
#     									 "Mínimo" = round(min(!!variavel), 2),
#     									 "Máximo" = round(max(!!variavel), 2),
#     									 "Desvio Padrão" = round(sd(!!variavel), 2),
#     									 "Variância" = round(var(!!variavel), 2))
#     resultado[, "Variável"] <- variavel
#     resultado <- resultado %>% dplyr::relocate("Variável", .before = 1)  
#   return(resultado)
# }
```

# Base de dados

```{r, include=FALSE, echo=FALSE}
baseCDC <- openxlsx::read.xlsx("../data/baseCDC.xlsx")
str(baseCDC)
baseCDC$duracao <- (as.numeric(substr(chron::times(baseCDC$duracao),1,2)) * 60) + as.numeric(substr(chron::times(baseCDC$duracao),4,5)) + (as.numeric(substr(chron::times(baseCDC$duracao),7,8)) / 60)


baseCDC$horario_inicio <- NULL
baseCDC$horario_termino <- NULL
baseCDC$curso <- "CDC"


possiveis <- row.names(baseCDC[baseCDC$tratamento == "Sem música" & baseCDC$formato_ensino == "Remota", ])
set.seed(27)
retirar <- sample(possiveis, 1)
baseCDC <- baseCDC[-as.numeric(retirar), ]
table(baseCDC$formato_ensino, baseCDC$tratamento)

baseCDC <- baseCDC %>% dplyr::mutate_at(c(1, 3, 4, 5, 8:28), as.factor)
str(baseCDC)
```

```{r, include=FALSE, echo=FALSE}
baseMAT <- openxlsx::read.xlsx("../data/baseMAT.xlsx")
baseMAT$curso <- "MAT"
baseMAT$horario_inicio <- NULL
baseMAT$horario_termino <- NULL
baseMAT$duracao <- (as.numeric(substr(chron::times(baseMAT$duracao),1,2)) * 60) + as.numeric(substr(chron::times(baseMAT$duracao),4,5)) + (as.numeric(substr(chron::times(baseMAT$duracao),7,8)) / 60)

baseMAT$q1 <- ifelse(baseMAT$q1 == "d)", 1, 0)
baseMAT$q2 <- ifelse(baseMAT$q2 == "d) 130º)", 1, 0)
baseMAT$q3 <- ifelse(baseMAT$q3 == "c) 66", 1, 0)
baseMAT$q4 <- ifelse(baseMAT$q4 == "d) 6", 1, 0)
baseMAT$q5 <- ifelse(baseMAT$q5 == "c) 9", 1, 0)
baseMAT$q6 <- ifelse(baseMAT$q6 == "d)", 1, 0)
baseMAT$q7 <- ifelse(baseMAT$q7 == "c)", 1, 0)
baseMAT$q8 <- ifelse(baseMAT$q8 == "a)", 1, 0)
baseMAT$q9 <- ifelse(baseMAT$q9 == "a) g é bijetora.", 1, 0)
baseMAT$q10 <- ifelse(baseMAT$q10 == "b)", 1, 0)
baseMAT$q11 <- ifelse(baseMAT$q11 == "d)", 1, 0)
baseMAT$q12 <- ifelse(baseMAT$q12 == "Reflexiva e Anti-simétrica", 1, 0)
baseMAT$q13 <- ifelse(baseMAT$q13 == "c)", 1, 0)
baseMAT$q14 <- ifelse(baseMAT$q14 == "c", 1, 0)
baseMAT$q15 <- ifelse(baseMAT$q15 == "Verdadeiro", 1, 0)
baseMAT$q16 <- ifelse(baseMAT$q16 == "e) Ângulo Ângulo (A.A.)", 1, 0)
baseMAT$q17 <- ifelse(baseMAT$q17 == "a) Baricentro", 1, 0)
baseMAT$q18 <- ifelse(baseMAT$q18 == "Falso", 1, 0)
baseMAT$q19 <- ifelse(baseMAT$q19 == "d) Triângulo", 1, 0)
baseMAT$q20 <- ifelse(baseMAT$q20 == "b) Ângulo Lado Ângulo (A.L.A.)", 1, 0)

baseQuestoes <- baseMAT |> dplyr::select(8:27)
library(magrittr)
baseQuestoes <- baseQuestoes %>% dplyr::mutate(soma = rowSums(.))
baseMAT$numero_acertos <- baseQuestoes$soma

baseMAT <- baseMAT %>% dplyr::mutate_at(c(1, 3, 4, 5, 8:28), as.factor)
```

```{r, echo=FALSE}
base <- rbind(baseCDC, baseMAT)
base %>% head() %>% knitr::kable()
```

```{r, include=FALSE, echo=FALSE}

```


# Análise Geral

## Por Bloco

```{r, echo=FALSE}
# descritiva(df = base, variavel = "idade", grupo = "formato_ensino")
```

```{r, echo=FALSE, fig.align='center'}
boxplot(
  df = base,
  Y = "numero_acertos",
  X = "formato_ensino",
  Title = "Número de Acertos por Formato de Ensino",
  labelX = "Número de Acertos",
  labelY = "Formato de Ensino"
)
```

```{r, echo=FALSE}
Anova(base, "numero_acertos ~ formato_ensino", c("Formato do Ensino"))[[2]] %>% knitr::kable()
```


## Por Tratamento

```{r}
boxplot(
  df = base,
  Y = "numero_acertos",
  X = "tratamento",
  Title = "Número de Acertos por Tratamento",
  labelX = "Número de Acertos",
  labelY = "Tratamento"
)
```


```{r}
Anova(baseCDC, "numero_acertos ~ tratamento", c("Tratamento"))[[2]] %>% knitr::kable()
```

## Iteração


```{r, echo=FALSE, fig.align='center'}
boxplot(
  df = base,
  Y = "numero_acertos",
  X = "formato_ensino",
  grupo = "tratamento",
  Title = "Número de Acertos por Formato de Ensino",
  labelX = "Número de Acertos",
  labelY = "Formato de Ensino",
  legend = "Tratamento"
)
```

```{r}
Anova(base, "numero_acertos ~ formato_ensino * tratamento", c("Formato do Ensino", "Tratamento", "Formato do Ensino : Tratamento"))[[2]] %>% knitr::kable()
```



# Análise CDC




# Análise Matemática






